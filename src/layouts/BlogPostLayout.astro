---
import BaseLayout from './BaseLayout.astro';
import { authors } from '../data/authors';
import { formatBlogDate } from '../utils/blog';

interface Props {
  title: string;
  author: string;
  date: Date;
  description?: string;
}

const { title, author, date, description } = Astro.props;

const authorInfo = authors[author] || { displayName: author, url: '#' };
---

<BaseLayout title={title} description={description}>
  <nav class="blog-breadcrumbs" aria-label="Breadcrumb">
    <ol class="blog-breadcrumbs-inner">
      <li><a href="/">Node-RED</a></li>
      <li><a href="/blog/">Blog</a></li>
    </ol>
  </nav>

  <article class="blog-post">
    <div class="blog-post-inner">
      <header class="blog-post-header">
        <h1>{title}</h1>
        <div class="blog-post-meta">
          <time datetime={date.toISOString()}>{formatBlogDate(date)}</time>
          <span class="separator" aria-hidden="true">|</span>
          <a href={authorInfo.url} target="_blank" rel="noopener">{authorInfo.displayName}</a>
        </div>
      </header>

      <div class="blog-post-content">
        <slot />
      </div>
    </div>
  </article>
</BaseLayout>

<style>
  .blog-breadcrumbs {
    background: #C75050;
    min-height: 50px;
    display: flex;
    align-items: center;
  }

  .blog-breadcrumbs-inner {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    width: 100%;
    display: flex;
    list-style: none;
    gap: 0;
  }

  .blog-breadcrumbs-inner li::before {
    content: '/';
    color: rgba(255, 255, 255, 0.6);
    margin: 0 10px;
  }

  .blog-breadcrumbs-inner li:first-child::before {
    content: '';
    margin: 0;
  }

  .blog-breadcrumbs a {
    color: white;
    font-family: 'Roboto Slab', serif;
    font-size: 16px;
    text-decoration: none;
  }

  .blog-breadcrumbs a:hover {
    text-decoration: underline;
    color: white;
  }

  .blog-post {
    background: #fff;
    max-width: 900px;
    margin: 32px auto;
    border-radius: 12px;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
  }

  .blog-post-inner {
    padding: 48px 56px;
  }

  .blog-post-header {
    margin-bottom: 32px;
    padding-bottom: 24px;
    border-bottom: 3px solid #C75050;
  }

  .blog-post-header h1 {
    font-size: 34px;
    margin-bottom: 16px;
    line-height: 1.3;
  }

  .blog-post-meta {
    color: #6B6B6B;
    font-size: 14px;
  }

  .blog-post-meta a {
    color: #C75050;
    text-decoration: underline;
  }

  .blog-post-meta .separator {
    margin: 0 10px;
  }

  .blog-post-content {
    font-size: 17px;
    line-height: 1.8;
  }

  .blog-post-content :global(h2) {
    font-size: 24px;
    margin: 40px 0 16px;
  }

  .blog-post-content :global(h3) {
    font-size: 20px;
    margin: 32px 0 12px;
  }

  .blog-post-content :global(p) {
    margin: 16px 0;
  }

  .blog-post-content :global(ul),
  .blog-post-content :global(ol) {
    margin: 16px 0;
    padding-left: 28px;
  }

  .blog-post-content :global(li) {
    margin: 6px 0;
  }

  .blog-post-content :global(img) {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    margin: 24px 0;
  }

  .blog-post-content :global(blockquote) {
    border-left: 4px solid #C75050;
    margin: 24px 0;
    padding: 12px 24px;
    background: #fafafa;
    border-radius: 0 8px 8px 0;
  }

  @media (max-width: 768px) {
    .blog-post-inner {
      padding: 28px 20px;
    }

    .blog-post-header h1 {
      font-size: 26px;
    }
  }
</style>
